!function(a,b,c){"use strict";var d=function(a){this.OPTIONS=b.extend({version:"1.1.0",childDOM:{$priceRangeBar:a.element.children(".mrco-price-range-bar"),$priceRangeSlider:a.element.find(".mrco-price-range-slider"),$priceSelectedBar:a.element.find(".mrco-price-selected-slider"),$priceDian:a.element.find(".mrco-price-icon-dian-list"),$priceList:a.element.children(".mrco-price-list"),$priceBtn:a.element.children(".mrco-drag-btn"),$priceTipBox:a.element.children(".mrco-price-tip-box")},dataPrice:function(){var b=[],c=a.priceScale,d=null,e=0;for(var f in c){d=c[f],e=d.price,b.push(e);for(var g=0,h=d.count;h>g;g++)e+=d.scale,b.push(e)}return b}(),priceRuler:a.rulerSize?a.rulerSize+6:parseInt(a.element.find(".mrco-price-icon-dian-list").children("i:first").css("marginRight").replace("px",""))+6,rangeBarMarginLeft:parseInt(a.element.children(".mrco-price-range-bar").css("marginLeft")),minPrice:"*"==a.minPrice?"*":parseInt(a.minPrice),maxPrice:"*"==a.maxPrice?"*":parseInt(a.maxPrice),startPrice:"*"==a.startPrice?"*":a.startPrice,endPrice:"*"==a.endPrice?"*":a.endPrice,btnOffset:{left:20,right:a.element.children(".mrco-price-range-bar").width()},changeCallback:"function"==typeof a.changeCallback?a.changeCallback:function(){}},a),this.utils={replaceData:function(a,b){return a.replace(/(\{(.*?)\})/g,function(a,c,d){return"null"==b[d]?"":b[d]})},isEmpty:function(a){return/^\s*$/g.test(a)}}};return d.fn=d.prototype,d.fn.builderPriceDian=function(){var a=this,b="",c="",d=a.OPTIONS.priceScale,e=a.OPTIONS.priceRuler;for(var f in d){for(var g=d[f],h=e,i='<i class="mrco-price-icon-dian"></i>',j='<li style="width:{width}px;"><span>{price}</span></li>',k=0,l=g.count;l>k;k++)i+='<i class="mrco-price-icon-dian icon-dian-hide"></i>',h+=e;g.price>99&&(h*=3),c+=a.utils.replaceData(j,{width:h,price:0===g.price?"&nbsp;&nbsp;":g.price+"万"}),b+=i}return a.OPTIONS.childDOM.$priceDian.html(b),a.OPTIONS.childDOM.$priceList.html(c),a},d.fn.setPriceRangeSlider=function(){var a=this;return a.OPTIONS.childDOM.$priceRangeSlider.css({width:function(){var b=a.OPTIONS.dataPrice,c=0;if("number"!=typeof a.OPTIONS.maxPrice&&"*"===a.OPTIONS.maxPrice){for(var d=0,e=b.length;e>d;d++)parseInt(b[d])<a.OPTIONS.minPrice&&c++;return a.OPTIONS.childDOM.$priceRangeBar.width()-c*a.OPTIONS.priceRuler}for(var d=0,e=b.length;e>d;d++)parseInt(b[d])>=a.OPTIONS.minPrice&&parseInt(b[d])<=a.OPTIONS.maxPrice&&c++;return(c-1)*a.OPTIONS.priceRuler}(),left:function(){for(var b=a.OPTIONS.dataPrice,c=0,d=0,e=b.length;e>d;d++)parseInt(b[d])<a.OPTIONS.minPrice&&c++;return c*a.OPTIONS.priceRuler}()+"px"}),a},d.fn.setBtnPriceDefaultSelected=function(){var a=this,c=b(a.OPTIONS.childDOM.$priceBtn),d=a.OPTIONS.childDOM.$priceSelectedBar,e=function(b){var c=a.OPTIONS.dataPrice,d=0;if("number"!=typeof b&&"*"===b)return a.OPTIONS.childDOM.$priceRangeBar.width();for(var e=0,f=c.length;f>e;e++)parseInt(c[e])<b&&d++;return d*a.OPTIONS.priceRuler+a.OPTIONS.rangeBarMarginLeft},f=e(a.OPTIONS.startPrice),g=e(a.OPTIONS.endPrice);return c.eq(0).css({left:f+"px"}),c.eq(1).css({left:g+"px"}),d.css({width:g-f+"px",left:f-a.OPTIONS.rangeBarMarginLeft/2+"px"}),a.showPriceTipBox({left:f+(g-f)/2-36,priceText:a.getPriceText(f,g)}),a.OPTIONS.btnOffset.left=f,a.OPTIONS.btnOffset.right=g,a},d.fn.showPriceTipBox=function(a){var b=this,c=b.OPTIONS.childDOM.$priceTipBox;"object"==typeof a&&(c.css({left:a.left+"px"}).children("span").text(a.priceText),c.show())},d.fn.getPriceText=function(a,b){var c=this,d=parseInt((a-10)/c.OPTIONS.priceRuler),e=parseInt((b-10)/c.OPTIONS.priceRuler),f=c.OPTIONS.dataPrice,g=parseInt(f[d]),h=parseInt(f[e]);return c.OPTIONS.startPrice=0===d&&0===e?0:d>f.length-1?f[f.length-1]:g,c.OPTIONS.endPrice=e>=f.length?"*":h,isNaN(g)&&isNaN(h)?f[f.length-1]+"万以上":0===d&&isNaN(h)?g+"-"+f[f.length-1]+"万以上":isNaN(h)?g+"万以上":0===g&&h>f[2]?h+"万以下":g==h?0===d?g+"万以下":g+"万":h>g?g+"-"+h+"万":h+"万以上"},d.fn.priceBtnMouseDragEvent=function(){var a,c=this,d=!1,e=c.OPTIONS.childDOM.$priceSelectedBar,f=c.OPTIONS.childDOM.$priceRangeBar,g=f.width(),h=f.offset().left-10,i=c.OPTIONS.rangeBarMarginLeft,j=c.OPTIONS.dataPrice,k=10,l=c.OPTIONS.btnOffset,m=function(c){d=!0,a=b(this)},n=function(b){if(d){var f,m,n=b.pageX<=h?0:b.pageX-h;if(a.hasClass("mrco-drag-btn-left")){if(f=i>=n?i:n,f>l.right)return;l.left=f,a.css({left:l.left+"px","z-index":++k})}if(a.hasClass("mrco-drag-btn-right")){if(m=b.pageX>=g+h?g:n,j[0]>0&&m<l.left)return;if(20===l.left&&0===j[0]&&m<l.left+26)return;if(m<l.left)return;l.right=m,a.css({left:l.right+"px","z-index":++k})}c.showPriceTipBox({left:l.left+(l.right-l.left)/2-36,priceText:c.getPriceText(l.left,l.right)}),e.css({width:l.right-l.left+"px",left:l.left-i/2+"px"})}},o=function(){d&&c.OPTIONS.changeCallback({startPrice:c.OPTIONS.startPrice,endPrice:c.OPTIONS.endPrice}),d=!1};return b(c.OPTIONS.childDOM.$priceBtn).bind("mousedown",m).show(),b(window.document).bind("mousemove",n).bind("mouseup",o),c},d.fn.bindRangeBarClickListener=function(){var a=this;return a.OPTIONS.childDOM.$priceRangeBar.bind("mousedown",function(c){var d,e=a.OPTIONS.childDOM.$priceSelectedBar,f=a.OPTIONS.btnOffset,g=a.OPTIONS.rangeBarMarginLeft,h=a.OPTIONS.childDOM.$priceRangeBar,i=h.offset().left-10,j=c.pageX<=i?0:c.pageX-i;b(c.target).hasClass("mrco-price-selected-slider")&&(d=b(c.target).width()/2>c.offsetX?"left":"right"),(j<=f.left||"left"==d)&&(f.left=j,a.OPTIONS.childDOM.$priceBtn.eq(0).css({left:f.left+"px"})),(j>=f.right||"right"==d)&&(f.right=j,a.OPTIONS.childDOM.$priceBtn.eq(1).css({left:f.right+"px"})),e.css({width:f.right-f.left+"px",left:f.left-g/2+"px"}),a.showPriceTipBox({left:f.left+(f.right-f.left)/2-36,priceText:a.getPriceText(f.left,f.right)}),setTimeout(function(){a.OPTIONS.changeCallback({startPrice:a.OPTIONS.startPrice,endPrice:a.OPTIONS.endPrice})},200)}),a},d.fn.init=function(){this.builderPriceDian().priceBtnMouseDragEvent().setPriceRangeSlider().setBtnPriceDefaultSelected().bindRangeBarClickListener()},b.dragBar?void new Error("错误：检测到jQuery运行环境中已存在一个名为DragBar的对象。"):void(b.fn.dragBar=function(a){new d(b.extend({element:this},a)).init()})}(window,jQuery);