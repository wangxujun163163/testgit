!function(a,b,c){"use struct";if(!b)throw new Error("错误：未找到jQuery类库，请先引用jQuery类库后再使用mc.clock.js");a.mcClockStore=[];var d=function(a){this.OPTIONS=b.extend({element:null,startTime:new Date("2015/9/5 23:26:00"),endTime:new Date("2015/9/10 23:00:00"),nowTime_Server:new Date("2015/9/8 18:01:55"),nowTime_Client:new Date,param:0,timer:null},a),this.OPTIONS.param=this.OPTIONS.nowTime_Client-this.OPTIONS.nowTime_Server,this.createTimeElement(),this.clearCountTime()};d.fn=d.prototype,d.fn.createTimeElement=function(){var a=['<span data-time="dd" class="mc-clock-time">0</span>','<span class="mc-clock-txt">天</span>','<span data-time="hh" class="mc-clock-time">0</span>','<span class="mc-clock-txt">时</span>','<span data-time="mm" class="mc-clock-time">0</span>','<span class="mc-clock-txt">分</span>','<span data-time="ss"class="mc-clock-time">0</span>'].join("");return this.OPTIONS.element.html(a),this},d.fn.setTime=function(a){var b=Math.floor(a/864e5),c=Math.floor(a/36e5)%24,d=Math.floor(a/6e4)%60,e=Math.floor(a/1e3)%60,f=this.OPTIONS.element,g=function(a){return 10>a?"0"+a:a};return f.children("span[data-time=dd]").text(g(b)),f.children("span[data-time=hh]").text(g(c)),f.children("span[data-time=mm]").text(g(d)),f.children("span[data-time=ss]").text(g(e)),this},d.fn.startTime=function(){var a,b,c=this,d=new Date;if(d.setTime(d.getTime()-c.OPTIONS.param),a=d-c.OPTIONS.startTime,b=c.OPTIONS.endTime-d,a>0&&b>0)c.setTime(b);else if(0>b)return console.log("已经结束"),void c.setTime(0);return c.OPTIONS.timer=setTimeout(function(){c.startTime()},1e3),this},d.fn.clearCountTime=function(){var b=this.OPTIONS.element.attr("mc-clock-idx");if(b){var c=a.mcClockStore[b];c&&clearTimeout(c.OPTIONS.timer),a.mcClockStore[b]=this}return this},a.mcClock=d,b(function(){b("[mc-clock-id]").each(function(c){var e,f=b(this),g=f.attr("end-time"),h=f.attr("server-time");g&&h&&(e=new d({element:f,endTime:new Date(g.replace(/-/g,"/")),nowTime_Server:new Date(h.replace(/-/g,"/"))}).startTime()),a.mcClockStore.push(e),f.attr("mc-clock-idx",c)})})}(window,jQuery);