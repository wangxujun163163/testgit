!function(a,b,c){"use strict";var d=function(a){this.OPTIONS=b.extend({label:{order:{title:"我的订单",titleurl:"/order/list",blank:"您还没有订单"},tuan:{title:"我的团购",titleurl:"/tuan/list",blank:"您还没有参加团购"},focusmsg:{loading:"消息通知",loadingurl:"#",focus:{title:"降价通知",blank:"您还没有订阅降价通知",more:"查看全部降价",moreurl:"/focus/list"},msg:{title:"消息通知",blank:"您还没有消息哦！",more:"查看全部消息",moreurl:"/message/list"}},coupon:{title:"我的资产",titleurl:"/coupon/list",blank:"您还没有购车红包哦！"},quoterecord:{loading:"我看过的",loadingurl:"",quote:{title:"报价记录",blank:"您还没有查看过报价",more:"更早报价记录",moreurl:"/quote/list"},record:{title:"浏览记录",blank:"您还没有浏览过任何车型",more:"更早浏览记录",moreurl:"/record/list"}}},status:0,data:null},a)};return d.fn=d.prototype,d.fn.getData=function(a){var c=this;return c.OPTIONS.status=1,b.ajax({url:"/aj_user/sideBar",data:{},dataType:"json",type:"post",success:function(d){if(d&&0==d.code){c.OPTIONS.status=2,c.OPTIONS.data=d.content;var e=parseInt(d.content.user.gender);b("#spIconAvatar").html('<a href="/user/"><img class="avatar" src="/img/icon_user_avatar_'+(0==e?"fe":"")+'male.png" /></a>'),a&&a()}return c},error:function(a){return c}}),c},d.fn.createUISidePanel=function(){var a=this,c='<div class="sidepanel_wrap" id="spSidePanelWrap">   <div class="sidepanel_bar" id="spSidePanelBar">       <div class="sidepanel_bar_uc">           <div class="icon_avatar blank" id="spIconAvatar"><a href="javascript:void(0);"><img class="avatar" src="/img/sidebar/avatar.png" /></a></div>           <div class="icon_item label detail" detail="order"><img class="icon" src="/img/sidebar/order.png" /><span class="label">订<br/>单</span></div>           <div class="icon_item label detail last" detail="tuan"><img class="icon" src="/img/sidebar/tuan.png" /><span class="label">秒<br/>车<br/>团</span></div>           <div class="icon_item icon detail" detail="focusmsg"><img class="icon" src="/img/sidebar/msg.png" /><span class="tips">消息通知</span></div>           <div class="icon_item icon detail" detail="coupon"><img class="icon" src="/img/sidebar/coupon.png" /><span class="tips">我的资产</span></div>           <div class="icon_item icon detail" detail="quoterecord"><img class="icon" src="/img/sidebar/record.png" /><span class="tips">我看过的</span></div>       </div>       <div class="sidepanel_bar_qq">           <div class="icon_item icon" id="BizQQWPA1"><img class="icon" src="/img/sidebar/qq.png" /><span class="tips">在线客服</span></div>           <div class="icon_item icon" id="spBackTop"><img class="icon" src="/img/sidebar/top.png" /><span class="tips">返回顶部</span></div>       </div>   </div>   <div class="sidepanel_con" id="spSidePanelCon"></div></div>',d=a.OPTIONS.element;return d.append(b(c)),a},d.fn.createUIOrder=function(a){var c={"-1":"已<br/>删除",0:"待<br/>付款",1:"待<br/>付款",2:"已<br/>付款",3:"已<br/>发码",4:"已<br/>到店",5:"已<br/>购车",6:"退款<br/>中",7:"已<br/>退款",8:"退款<br/>中",9:"已<br/>退款",10:"已<br/>退单",11:"已<br/>退单",12:"订单<br/>转出"},d=this,e=d.OPTIONS.data.order,f=d.OPTIONS.label[a],g=[];if(g.push('<a class="jump_title" href="'+f.titleurl+'">'+f.title+"</a>"),g.push('<div class="sp_scroll_con">'),e&&e.length)for(var h=0;h<e.length;h++){var i=e[h];g.push('<a class="sp_order_item" href="'+i.url+'">'),g.push('<img class="spec_img" src="'+i.simg+'" />'),g.push('<p class="spec_name">'+i.spec_name+"</p>"),g.push('<p class="spec_price"><span class="base_price">￥'+mclib.formatPrice(mclib.getPrice(i.base_price))+"</span>"),g.push('<span class="msrp"><s'+(mclib.getPrice(i.base_price)>mclib.getPrice(i.msrp)?' class="nolinethrough"':"")+">￥"+mclib.formatPrice(mclib.getPrice(i.msrp))+"</s></span></p>"),g.push('<span class="spec_badge">'+c[i.status]+"</span>"),g.push("</a>")}else g.push(d.createUIBlank(a));g.push("</div>");var j=b(g.join(""));return j},d.fn.createUITuan=function(a){var c=["周日","周一","周二","周三","周四","周五","周六"],d={1:"未签到",2:"签到",3:"未成交",4:"成交"},e=this,f=e.OPTIONS.data.tuangou,g=e.OPTIONS.label[a],h=[];if(h.push('<a class="jump_title" href="'+g.titleurl+'">'+g.title+"</a>"),h.push('<div class="sp_scroll_con">'),f&&f.length)for(var i=0;i<f.length;i++){var j=f[i],k=j.acttime,l=k.split(" "),m=l[0].split("-"),n=new Date(l[0].replace(/-/g,"/")),o=n.getDay(),p=parseInt(l[1].split(":")[0])>=12?"上午":"下午",q=n.getTime(),r=(new Date).getTime(),s=new Date(q+864e5).getTime(),t="进行中";r>s&&(t="已结束"),h.push('<a class="sp_tuan_item" href="/tuan/list">'),h.push('<p class="name">['+j.area+"] "+j.display_name+'<span class="red">'+j.apply_num+"人报名</span></p>"),h.push('<p class="time">开团时间 '+m[0]+"年"+m[1]+"月"+m[2]+"日 "+c[o]+" "+p+"</p>"),h.push('<p class="label"><span class="usr">'+d[j.status]+'</span><span class="mc">'+t+"</span></p>"),h.push("</a>")}else h.push(e.createUIBlank(a));h.push("</div>");var u=b(h.join(""));return u},d.fn.createUIFocusMsg=function(a){var c=this,d=c.OPTIONS.label[a],e=[];e.push('<div class="sp_tab"><span class="selected" tab="focus">'+d.focus.title+'</span><span tab="msg">'+d.msg.title+"</span></div>"),e.push('<div class="sp_scroll_con">');var f=c.OPTIONS.data.myfocus;if(e.push('<div class="sp_tab_con selected" tab="focus">'),f&&f.length){for(var g=0;g<f.length;g++){var h=f[g],i=mclib.getPrice(h.focus_price),j=mclib.getPrice(h.curr_price),k=mclib.getPrice(i-j),l="无价格变化";k>0?l="降价 ￥"+mclib.formatPrice(k):0>k&&(l="涨价 ￥"+mclib.formatPrice(-k)),e.push('<a class="sp_series_item" href="/focus/list" title="'+h.name+'">'),e.push('<img class="series_img" src="'+h.img+'" />'),e.push('<p class="mask">查看详情</p>'),e.push('<p class="name">'+h.series_name+"</p>"),e.push('<p class="price">'+l+"</p>"),e.push("</a>")}e.push('<a class="jump_more" href="'+d.focus.moreurl+'">'+d.focus.more+"</a>")}else e.push(c.createUIBlank(a,"focus"));e.push("</div>");var f=c.OPTIONS.data.msg;if(e.push('<div class="sp_tab_con" tab="msg">'),f&&f.length){for(var g=0;g<f.length;g++){var m=f[g];e.push('<a class="sp_msg_item" href="/message/list">'),e.push('<p class="title">'+m.title+"</p>"),e.push('<p class="txt">'+m.content+"</p>"),e.push("</a>")}e.push('<a class="jump_more" href="'+d.msg.moreurl+'">'+d.msg.more+"</a>")}else e.push(c.createUIBlank(a,"msg"));e.push("</div>"),e.push("</div>");var n=b(e.join(""));return n},d.fn.createUICoupon=function(a){var c=this,d=c.OPTIONS.data.coupon,e=c.OPTIONS.label[a],f=[];f.push('<a class="jump_title" href="'+e.titleurl+'">'+e.title+"</a>"),f.push('<div class="sp_scroll_con">'),d&&d.length||f.push(c.createUIBlank(a)),f.push("</div>");var g=b(f.join(""));return g},d.fn.createUIQuoteRecord=function(a){var c=this,d=c.OPTIONS.label[a],e=[];e.push('<div class="sp_tab"><span class="selected" tab="quote">'+d.quote.title+'</span><span tab="record">'+d.record.title+"</span></div>"),e.push('<div class="sp_scroll_con">');var f=c.OPTIONS.data.quote_list;if(e.push('<div class="sp_tab_con selected" tab="quote">'),f&&f.length){for(var g=0;g<f.length;g++){var h=f[g],i=mclib.getPrice(h.base_price),j=mclib.getPrice(h.msrp),k="--";if(j>=i){var l=mclib.getPrice(j-i);k=mclib.formatPrice(l)}e.push('<a class="sp_quote_item" href="/quote/list">'),e.push('<img class="quote_img" src="'+h.special_img+'" />'),e.push('<p class="name">'+h.special_name+"</p>"),e.push('<p class="price">优惠￥'+k+"</p>"),e.push("</a>")}e.push('<a class="jump_more" href="'+d.quote.moreurl+'">'+d.quote.more+"</a>")}else e.push(c.createUIBlank(a,"quote"));e.push("</div>");var f=c.OPTIONS.data.browse_history;if(e.push('<div class="sp_tab_con" tab="record">'),f&&f.length){for(var g=0;g<f.length;g++){var m=f[g];e.push('<a class="sp_series_item" href="'+m.url+'" title="'+m.spec_name+'">'),e.push('<img class="series_img" src="'+m.img+'" />'),e.push('<p class="mask">查看详情</p>'),e.push('<p class="name">'+m.series_name+"</p>"),e.push('<p class="price">'+m.discount+"折起</p>"),e.push("</a>")}e.push('<a class="jump_more" href="'+d.record.moreurl+'">'+d.record.more+"</a>")}else e.push(c.createUIBlank(a,"record"));e.push("</div>"),e.push("</div>");var n=b(e.join(""));return n},d.fn.createUIBlank=function(a,b){var c=this,d=c.OPTIONS.label[a],e=d;b&&(e=d[b]);var f=[];f.push('<p class="blank gray">'+e.blank+"</p>");var g=c.OPTIONS.data.tuan_rec;if(g){var h=g.brand_name,i=g.apply_num+"",j=g.area,k=g.url;h&&i&&j&&k&&(f.push('<p class="blank tuan">['+j+"] "+h+"已有"+i+"人报名团购</p>"),f.push('<a class="jump_tuan" href="'+k+'">去秒车团看看</a>'))}return f.join("")},d.fn.createUILoading=function(a){var c=this,d=c.OPTIONS.label[a],e=[];e.push('<a class="jump_title" href="'+(d.loadingurl||d.titleurl)+'">'+(d.loading||d.title)+"</a>"),e.push('<div class="sp_scroll_con">'),e.push('<p class="blank"><img src="/img/icon_confirm_loading.gif" /></p>'),e.push("</div>");var f=b(e.join(""));return f},d.fn.showDetail=function(a){function c(a){b("#spSidePanelCon .sp_tab span").removeClass("selected"),b("#spSidePanelCon .sp_tab span[tab="+a+"]").addClass("selected"),b("#spSidePanelCon .sp_tab_con").removeClass("selected"),b("#spSidePanelCon .sp_tab_con[tab="+a+"]").addClass("selected")}var d,e=this,f=e.OPTIONS.status;if(0==f||1==f)d=e.createUILoading(a),0==f&&e.getData(function(){a=b("#spSidePanelBar .icon_item.detail.selected").attr("detail"),e.showDetail(a)});else switch(a){case"order":d=e.createUIOrder(a);break;case"tuan":d=e.createUITuan(a);break;case"focusmsg":d=e.createUIFocusMsg(a);break;case"coupon":d=e.createUICoupon(a);break;case"quoterecord":d=e.createUIQuoteRecord(a);break;default:d=b("")}b("#fake_spSidePanelCon").remove();var g=b("#spSidePanelCon").clone();return g.attr("id","fake_spSidePanelCon"),b("#spSidePanelCon").before(g),b("#fake_spSidePanelCon").css({top:0}),b("#fake_spSidePanelCon").animate({top:100,left:100,width:130,opacity:0},function(){b("#fake_spSidePanelCon").remove()}),b("#spSidePanelCon").empty().append(d),b("#spSidePanelCon").css({top:600}),b("#spSidePanelCon").animate({top:0}),b("#spSidePanelCon .sp_tab span").on("click",function(){var a=b(this).attr("tab");c(a)}),e},d.fn.empty=function(){var a=this;return b("#spSidePanelCon").empty(),a},d.fn.bindEvent=function(){var a=this;return b(document).bind("click",function(c){var d=b(c.target);0==d.closest("#spSidePanelWrap").length&&b("#spSidePanelWrap").hasClass("detail")&&a.fold()}),b("#spSidePanelBar .icon_item.icon").hover(function(){var a=b(this);a.children("span.tips").show()},function(){var a=b(this);a.children("span.tips").hide()}),b("#spBackTop").on("click",function(){b("html,body").animate({scrollTop:0},500)}),b("#spSidePanelBar .icon_item.detail, #spSidePanelBar .icon_avatar.blank").on("click",function(){function c(){b("#spSidePanelWrap .onsalenotify_overlay_wrap").remove()}var d=b(this),e=d.attr("detail"),f=a.OPTIONS.status,g=d.closest(".icon_avatar").length;if(isLogin){if(g)return a;a.onIconClick(f,e)}else{var h=d.position().top+d.parent().position().top;h+370>b("#spSidePanelWrap").height()&&(h=b("#spSidePanelWrap").height()-370);var i={close:c,succ:function(b,d){updateTopBarUser(d.content),c(),g?a.getData():a.onIconClick(f,e)}};b("#spSidePanelWrap").modallogin(i),b("#spSidePanelWrap .onsalenotify_overlay_wrap").css({top:h}),b("#spSidePanelWrap").mouseleave(function(){c()})}}),a},d.fn.onIconClick=function(a,c){var d=this;if(b("#spSidePanelWrap").hasClass("detail")){var e=b("#spSidePanelBar .icon_item.detail[detail="+c+"]");e.hasClass("selected")?d.fold():(d.highlight(c),d.showDetail(c))}else d.unfold(c),d.highlight(c),d.showDetail(c);return d},d.fn.fold=function(){var a=this;return b("#spSidePanelWrap").animate({right:-260},"fast",function(){b("#spSidePanelWrap").removeClass("detail").css({right:0}),a.highlight(),a.empty()}),a},d.fn.unfold=function(a){var c=this;return b("#spSidePanelWrap").addClass("detail"),b("#spSidePanelWrap").css({right:-260}),b("#spSidePanelWrap").animate({right:0},"fast"),c},d.fn.highlight=function(a){var c=this;return b("#spSidePanelBar .icon_item.detail").removeClass("selected"),a&&b("#spSidePanelBar .icon_item.detail[detail="+a+"]").addClass("selected"),c},d.fn.init=function(){var a=this;return a.createUISidePanel(),a.bindEvent(),isLogin&&a.getData(),a},b.sidePanel?void new Error("duplicate sidepanel"):void(b.fn.sidePanel=function(a){new d(b.extend({element:this},a)).init()})}(window,jQuery);