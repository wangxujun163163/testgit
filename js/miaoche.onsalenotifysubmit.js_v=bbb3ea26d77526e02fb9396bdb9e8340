!function(a){var b='<div class="onsalenotify_overlay_wrap" id="onsalenotify_overlay_wrap">   <img class="close" src="/img/tuan/tuan_index_icon_close_pop.png" />   <div class="cntcon resuletok">       <br /><br /><br /><br /><br /><br />       <p class="icon loading"></p>       <p class="info">正在添加降价通知...</p>       <p class="subinfo">请勿关闭</p>       <br /><br /><br /><br /><br /><br />       <a class="link" href="/focus/list">查看我的降价通知</a>       <br /><br /><br /><br /><br /><br />   </div></div>';a.widget("miaoche.onsalenotifysubmit",{_init:function(){var c=this,d=c.options,e=c.element;if(!a("div.onsalenotify_overlay_wrap",e).length){e.append(b),d.code=-1,a("#onsalenotify_overlay_wrap .close").click(a.proxy(c.close,c));var f="/aj_focus/add",g={spec:d.spec,areaid:d.areaid};a.ajax({url:f,data:g,dataType:"json",type:"POST",success:function(b){if(b&&0==b.code){a("#onsalenotify_overlay_wrap .cntcon p.icon").removeClass("loading").addClass("ok"),a("#onsalenotify_overlay_wrap .cntcon p.info").text("您已成功订阅该车型降价通知"),a("#onsalenotify_overlay_wrap .cntcon p.subinfo").text("窗口3秒自动关闭"),d.code=0,d.onsalenotifyid=b.content;var e=3;d.intervalId=window.setInterval(function(){0>=e&&(window.clearInterval(d.intervalId),c.complete()),a("#onsalenotify_overlay_wrap .cntcon p.subinfo").text("窗口"+e+"秒自动关闭"),e--},1e3)}else a("#onsalenotify_overlay_wrap .cntcon p.icon").removeClass("loading").addClass("err"),a("#onsalenotify_overlay_wrap .cntcon p.info").text("订阅该车型降价通知失败"),a("#onsalenotify_overlay_wrap .cntcon p.subinfo").text("请重试"),d.code=1},error:function(b){a("#onsalenotify_overlay_wrap .cntcon p.icon").removeClass("loading").addClass("err"),a("#onsalenotify_overlay_wrap .cntcon p.info").text("订阅该车型降价通知失败"),a("#onsalenotify_overlay_wrap .cntcon p.subinfo").text("请重试"),d.code=1}})}},destroy:function(){this.element.find("div.onsalenotify_overlay_wrap").remove()},close:function(){var a=this,b=a.options;b.intervalId&&window.clearInterval(b.intervalId),0==b.code?this._trigger("complete",null,b.onsalenotifyid):this._trigger("close",null,null)},complete:function(){var a=this;this._trigger("complete",null,a.options.onsalenotifyid)}})}(jQuery);